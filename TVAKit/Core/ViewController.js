var ViewController=(function(){"use strict";return Class.create({__tvavcid:true,_init_:function(args){this.name=args.name||args.template;this.template=args.template;this.templateEngine=args.engine;this.$dom=null;this.rootID=null;this.parentVC=null;this.eventSubscriptions=[];this.children={};this.rendering=false;this.viewEvents=args.events||{};},saveState:function(){return{};},loadState:function(data){return true;},load:function(){this.$dom=this.templateEngine.load(this.template);this.rootID='#'+this.$dom.attr('id');this._parseEvents();},onLoad:function(){},unload:function(){if(this.parentVC===null){this._unloadChildren();this._unbindEvents();this._removeFromDOM();EventDispatcher.unsubscribe(this.eventSubscriptions);this.onUnload();}else{this.parentVC.removeChild(this.name);}},onUnload:function(){},_unload:function(){this._unloadChildren();this._unbindEvents();EventDispatcher.unsubscribe(this.eventSubscriptions);this.onUnload();},hide:function(){$(this.rootID).hide();},show:function(){$(this.rootID).show();},setParent:function(parent){this.parentVC=parent;},addChild:function(VC,place){this.children[VC.name]={view:VC,loadAt:place};VC.setParent(this);VC.onLoad();if(this.rendering&&place=="#Details"){VC.render(place);$('#detailsList > .Up_Arrow').hide();$('#detailsList > .Down_Arrow').show();$('.Left_Arrow.Arrow.hoverButton').hide();$('.Right_Arrow.Arrow.hoverButton').hide();}
else if(this.rendering&&(VC.activeChild=="rating_yes_btn"||VC.name=="ModalPinInsert")){VC.render(place);$('#detailsList > .Down_Arrow').hide();}
else if(this.rendering){VC.render(place);}},_unloadChildren:function(){for(var e in this.children){if(this.children.hasOwnProperty(e)){this.removeChild(e);}}},_removeChild:function(name){this.children[name].view._unload();},removeChild:function(name){if(this.children.ModalRating){$('#detailsList > .Down_Arrow').show();}
if(this.children.hasOwnProperty(name)){this._removeChild(name);this.children[name].view._removeFromDOM();}
delete this.children[name];},removeChildren:function(){for(var e in this.children){if(this.children.hasOwnProperty(e)){this.removeChild(e);}}},render:function(location){if(location==null){location='body';}
$(location).append(this.$dom);if(this.cloned)
{$('#'+this.template).attr('id',this.name);}
this.rendering=true;this._bindEvents();this._renderChildren();},_renderChildren:function(){var p;for(var e in this.children){if(this.children.hasOwnProperty(e)){p=this.children[e].loadAt;this.children[e].view.render(p);}}},_bindEvents:function(){this._eventBinder(true);},_unbindEvents:function(){this._eventBinder(false);},_parseEvents:function(){var events=this.viewEvents,event,eventData,eLength,eBinds,i;for(event in events){if(events.hasOwnProperty(event)){eventData=events[event];eLength=eventData.length;for(i=0;i<eLength;i+=1){eBinds=eventData[i].split(",");if(eBinds.length===2){var e=Utils.trim(eBinds[0]);var c=Utils.trim(eBinds[1]);if(c in this){this.viewEvents[event][i]={element:e,callback:c};}}}}}},_eventBinder:function(bind){var self=this,event,eventData,i,eLength,events=this.viewEvents,eBindings,$root=$(self.rootID);var binder=function(el,event,context){if(el.element===self.rootID){$root.bind(event,function(ev,data){self[el.callback](ev,data,context);});}else{$root.delegate(el.element,event,function(ev,data){self[el.callback](ev,data,context);});}};for(event in events){if(events.hasOwnProperty(event)){eventData=events[event];eLength=eventData.length;for(i=0;i<eLength;i+=1){eBindings=eventData[i];if(bind){binder(eBindings,event,this);}else{$root.undelegate(eBindings.element,event);}}}}},_removeFromDOM:function(){$(this.rootID).remove();},subscribe:function(event,callback,context){var c=context||this;this.eventSubscriptions.push(EventDispatcher.subscribe(event,callback,c));},publish:function(){EventDispatcher.publish.apply(EventDispatcher,arguments);}});})();